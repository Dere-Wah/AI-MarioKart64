{"cells":[{"cell_type":"markdown","source":["# **AI MarioKart64**\n","\n","https://derewah.dev/assets/blog/ai-mariokart/escaping.mp4\n","\n","https://derewah.dev/assets/blog/ai-mariokart/turn.mp4\n","\n","https://derewah.dev/assets/blog/ai-mariokart/tunnel.mp4\n","\n","https://github.com/Dere-Wah/AI-MarioKart64\n","\n","https://derewah.dev/projects/ai-mariokart\n","\n","This colab is what was used to train Diamond on MarioKart64. If you want to emulate the training, run the model, or adapt it to your needs, you're free to do so!\n","\n","**IMPORTANT** - Sometimes, during the running of this notebook, the machine will restart after installing dependencies. In that case, you'll have to navigate to your workplace path again. Also this assumes the training is being done in your Google Drive folder, so change directories path as necessary to do it in a different folder."],"metadata":{"id":"sFpMMc6p3x-d"}},{"cell_type":"markdown","source":["# Training"],"metadata":{"id":"lDXvko056uEw"}},{"cell_type":"markdown","source":["## First Time Setup - Downloading Repo & Processing Dataset\n","\n","**It is recommended to mount drive when doing a training run. A minimum 500GB of Drive Space is recommended when traning, as a lot of temporary files and checkpoints are stored.**\n","\n","**Also periodically empty your Drive bin to free up space.**\n","\n","---"],"metadata":{"id":"xlb4vb086xym"}},{"cell_type":"code","source":["!pip install datasets"],"metadata":{"id":"qA3VLrHT2ZSg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["cd /content/drive/MyDrive"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ds9iiNzi2iM3","executionInfo":{"status":"ok","timestamp":1732558173634,"user_tz":-60,"elapsed":2,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"6a1d5e63-04fb-4132-b924-f3f942dce0bc"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive\n"]}]},{"cell_type":"code","source":["!git clone https://github.com/Dere-Wah/AI-MarioKart64"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fYcXujvP2jgn","executionInfo":{"status":"ok","timestamp":1732558182348,"user_tz":-60,"elapsed":3394,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"5e37c6ea-96a4-4757-a168-f2a727cd548c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Cloning into 'AI-MarioKart64'...\n","remote: Enumerating objects: 427, done.\u001b[K\n","remote: Counting objects: 100% (135/135), done.\u001b[K\n","remote: Compressing objects: 100% (95/95), done.\u001b[K\n","remote: Total 427 (delta 74), reused 91 (delta 38), pack-reused 292 (from 1)\u001b[K\n","Receiving objects: 100% (427/427), 27.30 MiB | 21.23 MiB/s, done.\n","Resolving deltas: 100% (210/210), done.\n"]}]},{"cell_type":"code","source":["cd /content/drive/MyDrive/AI-MarioKart64/diamond\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YlW88hEE2pCf","executionInfo":{"status":"ok","timestamp":1732558184749,"user_tz":-60,"elapsed":445,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"e0da7664-fa53-46f0-8efc-95260d062312"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/AI-MarioKart64/diamond\n"]}]},{"cell_type":"code","source":["!git lfs install"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tFZJ0qlF74w3","executionInfo":{"status":"ok","timestamp":1732558186706,"user_tz":-60,"elapsed":440,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"3538424b-7d66-4f11-f923-5696fba81ad9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Updated git hooks.\n","Git LFS initialized.\n"]}]},{"cell_type":"code","source":["!git clone https://huggingface.co/datasets/DereWah/mk64-steering/"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ntnJLgK523Fn","executionInfo":{"status":"ok","timestamp":1732558303143,"user_tz":-60,"elapsed":89437,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"9102bdab-a2d4-4357-8b88-bdfca21bdba6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Cloning into 'mk64-steering'...\n","remote: Enumerating objects: 55, done.\u001b[K\n","remote: Counting objects: 100% (52/52), done.\u001b[K\n","remote: Compressing objects: 100% (51/51), done.\u001b[K\n","remote: Total 55 (delta 15), reused 0 (delta 0), pack-reused 3 (from 1)\u001b[K\n","Unpacking objects: 100% (55/55), 19.83 KiB | 26.00 KiB/s, done.\n","Filtering content: 100% (2/2), 4.57 GiB | 53.99 MiB/s, done.\n","fatal: cannot exec '/content/drive/MyDrive/AI-MarioKart64/diamond/mk64-steering/.git/hooks/post-checkout': Permission denied\n"]}]},{"cell_type":"markdown","source":["---\n","\n","**Install Requirements for Training**\n","\n","---"],"metadata":{"id":"JDXehNi8_GfH"}},{"cell_type":"code","source":["!pip install -r requirements.txt"],"metadata":{"id":"MQWWJnNP9Mj3"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["---\n","\n","**Whenever you install requirements you'll be required to restart the session. Simply navigate back to the training folder.**\n","\n","---"],"metadata":{"id":"tTbmaTGo_NDu"}},{"cell_type":"code","source":["cd /content/drive/MyDrive/AI-MarioKart64/diamond"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_DiLIH_G-Bw_","executionInfo":{"status":"ok","timestamp":1732558581784,"user_tz":-60,"elapsed":339,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"0b81bf5c-9aea-4c26-9be8-fdce7c9c2d5b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/AI-MarioKart64/diamond\n"]}]},{"cell_type":"code","source":["!python src/process_dataset_tar.py ./mk64-steering/LR/ ./processed"],"metadata":{"id":"UBygkTx58use"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**You are now ready to train!**\n","\n","Below you can find how to train a new run and how to resume an existing one.\n","\n","---"],"metadata":{"id":"6B6fgUTK9GIW"}},{"cell_type":"markdown","source":["## Training a New Run"],"metadata":{"id":"0RH2plgj9Ta5"}},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":295,"status":"ok","timestamp":1732559066406,"user":{"displayName":"Dere","userId":"05435981219959557895"},"user_tz":-60},"id":"wMOKMG3LEJFN","outputId":"f4d2ec38-1622-474c-c12a-7fb70406ab20"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/AI-MarioKart64/diamond\n"]}],"source":["cd /content/drive/MyDrive/AI-MarioKart64/diamond"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ayQUj8GZEOHd"},"outputs":[],"source":["!pip install -r requirements.txt"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rkSWPYoJEWDU"},"outputs":[],"source":["!pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":332,"status":"ok","timestamp":1732559107897,"user":{"displayName":"Dere","userId":"05435981219959557895"},"user_tz":-60},"id":"QYv2uA3zEkh1","outputId":"c062a559-88d0-4d84-c21f-1b58ad26d4a3"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/AI-MarioKart64/diamond\n"]}],"source":["cd /content/drive/MyDrive/AI-MarioKart64/diamond"]},{"cell_type":"markdown","metadata":{"id":"px6kTHJQ3mKm"},"source":["---\n","\n","### Optimal Values\n","\n","#### Model Configuration\n","- **Full Resolution (FULL RES):** 320x240  \n","- **Low Resolution (LOW RES):** 64x48  \n","- **Upsampling Factor:** 5  \n","\n","#### Optimal Settings\n","\n","| **VRAM**            | **Module**   | **Accumulation Steps** | **Batch Size** | **Note**          |\n","|----------------------|--------------|-------------------------|----------------|-------------------|\n","| **40 GB (Colab A100)** | **DENOISER** | 6 (6 × 100)            | 28             |                   |\n","|                      | **UPSAMPLER**| 1 (1 × 400)            | 4              |                   |\n","| **15 GB (Colab T4)**  | **DENOISER** | 6 (6 × 100)            | 5              |                   |\n","|                      | **UPSAMPLER**| 1 (1 × 400)            | 1              |                   |\n","\n","**If you want to save in costs and unnecessary run time, you can queue the immediate cell after the next one. It will automatically unassign the runtime whenever the training process stops (due to an error or training being finished).**\n","\n","---\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6Dh-TjrtRUMK"},"outputs":[],"source":["!python src/main.py"]},{"cell_type":"code","source":["from google.colab import runtime\n","runtime.unassign()"],"metadata":{"id":"F3fSi29GaSrl"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"9tkhBjwT1ooT"},"source":["# Resuming a Training Run\n","- Navigate to the last training session\n","- Grant user access to the resume.sh bash file\n","- Specify the batch size and grad acc parameters. Leave empty the path inputs."]},{"cell_type":"code","source":["cd /content/drive/MyDrive/AI-MarioKart64/diamond"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ST3YMo0iOSe3","executionInfo":{"status":"ok","timestamp":1732435880648,"user_tz":-60,"elapsed":232,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"06659b7a-d84d-4b05-db76-9bb268a42870"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/AI-MarioKart64/diamond\n"]}]},{"cell_type":"code","source":["pip install -r requirements.txt"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"ZZfebKp_OKRX","executionInfo":{"status":"ok","timestamp":1732435912040,"user_tz":-60,"elapsed":29918,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"7b99b199-bd0c-4085-df45-6005e5e212f2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting gymnasium==0.29.1 (from gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading gymnasium-0.29.1-py3-none-any.whl.metadata (10 kB)\n","Collecting h5py==3.11.0 (from -r requirements.txt (line 2))\n","  Downloading h5py-3.11.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.5 kB)\n","Collecting huggingface-hub==0.17.2 (from -r requirements.txt (line 3))\n","  Downloading huggingface_hub-0.17.2-py3-none-any.whl.metadata (13 kB)\n","Collecting hydra-core==1.3 (from -r requirements.txt (line 4))\n","  Downloading hydra_core-1.3.0-py3-none-any.whl.metadata (4.8 kB)\n","Collecting numpy==1.26.0 (from -r requirements.txt (line 5))\n","  Downloading numpy-1.26.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (58 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.5/58.5 kB\u001b[0m \u001b[31m2.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: opencv-python==4.10.0.84 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 6)) (4.10.0.84)\n","Collecting pillow==10.3.0 (from -r requirements.txt (line 7))\n","  Downloading pillow-10.3.0-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (9.2 kB)\n","Collecting pygame==2.5.2 (from -r requirements.txt (line 8))\n","  Downloading pygame-2.5.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (13 kB)\n","Collecting torcheval==0.0.7 (from -r requirements.txt (line 9))\n","  Downloading torcheval-0.0.7-py3-none-any.whl.metadata (8.6 kB)\n","Collecting tqdm==4.66.4 (from -r requirements.txt (line 10))\n","  Downloading tqdm-4.66.4-py3-none-any.whl.metadata (57 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m57.6/57.6 kB\u001b[0m \u001b[31m4.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting wandb==0.17.0 (from -r requirements.txt (line 11))\n","  Downloading wandb-0.17.0-py3-none-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (10 kB)\n","Requirement already satisfied: cloudpickle>=1.2.0 in /usr/local/lib/python3.10/dist-packages (from gymnasium==0.29.1->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1)) (3.1.0)\n","Requirement already satisfied: typing-extensions>=4.3.0 in /usr/local/lib/python3.10/dist-packages (from gymnasium==0.29.1->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1)) (4.12.2)\n","Collecting farama-notifications>=0.0.1 (from gymnasium==0.29.1->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading Farama_Notifications-0.0.4-py3-none-any.whl.metadata (558 bytes)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (3.16.1)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (2024.10.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (2.32.3)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (6.0.2)\n","Requirement already satisfied: packaging>=20.9 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (24.2)\n","Collecting omegaconf~=2.2 (from hydra-core==1.3->-r requirements.txt (line 4))\n","  Downloading omegaconf-2.3.0-py3-none-any.whl.metadata (3.9 kB)\n","Collecting antlr4-python3-runtime==4.9.* (from hydra-core==1.3->-r requirements.txt (line 4))\n","  Downloading antlr4-python3-runtime-4.9.3.tar.gz (117 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m117.0/117.0 kB\u001b[0m \u001b[31m9.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: click!=8.0.0,>=7.1 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (8.1.7)\n","Requirement already satisfied: docker-pycreds>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (0.4.0)\n","Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (3.1.43)\n","Requirement already satisfied: platformdirs in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (4.3.6)\n","Requirement already satisfied: protobuf!=4.21.0,<5,>=3.19.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (4.25.5)\n","Requirement already satisfied: psutil>=5.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (5.9.5)\n","Requirement already satisfied: sentry-sdk>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (2.18.0)\n","Requirement already satisfied: setproctitle in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (1.3.4)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (75.1.0)\n","Collecting shimmy<1.0,>=0.1.0 (from shimmy[atari]<1.0,>=0.1.0; extra == \"atari\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading Shimmy-0.2.1-py3-none-any.whl.metadata (2.3 kB)\n","Collecting autorom~=0.4.2 (from autorom[accept-rom-license]~=0.4.2; extra == \"accept-rom-license\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading AutoROM-0.4.2-py3-none-any.whl.metadata (2.8 kB)\n","Collecting AutoROM.accept-rom-license (from autorom[accept-rom-license]~=0.4.2; extra == \"accept-rom-license\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading AutoROM.accept-rom-license-0.6.1.tar.gz (434 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m434.7/434.7 kB\u001b[0m \u001b[31m18.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: six>=1.4.0 in /usr/local/lib/python3.10/dist-packages (from docker-pycreds>=0.4.0->wandb==0.17.0->-r requirements.txt (line 11)) (1.16.0)\n","Requirement already satisfied: gitdb<5,>=4.0.1 in /usr/local/lib/python3.10/dist-packages (from gitpython!=3.1.29,>=1.0.0->wandb==0.17.0->-r requirements.txt (line 11)) (4.0.11)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub==0.17.2->-r requirements.txt (line 3)) (3.4.0)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub==0.17.2->-r requirements.txt (line 3)) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub==0.17.2->-r requirements.txt (line 3)) (2.2.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub==0.17.2->-r requirements.txt (line 3)) (2024.8.30)\n","Collecting ale-py~=0.8.1 (from shimmy[atari]<1.0,>=0.1.0; extra == \"atari\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading ale_py-0.8.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.1 kB)\n","Requirement already satisfied: importlib-resources in /usr/local/lib/python3.10/dist-packages (from ale-py~=0.8.1->shimmy[atari]<1.0,>=0.1.0; extra == \"atari\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1)) (6.4.5)\n","Requirement already satisfied: smmap<6,>=3.0.1 in /usr/local/lib/python3.10/dist-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb==0.17.0->-r requirements.txt (line 11)) (5.0.1)\n","Downloading gymnasium-0.29.1-py3-none-any.whl (953 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m953.9/953.9 kB\u001b[0m \u001b[31m41.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading h5py-3.11.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.3 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m5.3/5.3 MB\u001b[0m \u001b[31m107.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading huggingface_hub-0.17.2-py3-none-any.whl (294 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m294.9/294.9 kB\u001b[0m \u001b[31m24.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading hydra_core-1.3.0-py3-none-any.whl (153 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m153.8/153.8 kB\u001b[0m \u001b[31m12.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading numpy-1.26.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.2 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m18.2/18.2 MB\u001b[0m \u001b[31m100.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pillow-10.3.0-cp310-cp310-manylinux_2_28_x86_64.whl (4.5 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.5/4.5 MB\u001b[0m \u001b[31m94.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pygame-2.5.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (14.0 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m14.0/14.0 MB\u001b[0m \u001b[31m106.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading torcheval-0.0.7-py3-none-any.whl (179 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m179.2/179.2 kB\u001b[0m \u001b[31m17.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading tqdm-4.66.4-py3-none-any.whl (78 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m78.3/78.3 kB\u001b[0m \u001b[31m7.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading wandb-0.17.0-py3-none-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (6.7 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6.7/6.7 MB\u001b[0m \u001b[31m112.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading AutoROM-0.4.2-py3-none-any.whl (16 kB)\n","Using cached Farama_Notifications-0.0.4-py3-none-any.whl (2.5 kB)\n","Downloading omegaconf-2.3.0-py3-none-any.whl (79 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m79.5/79.5 kB\u001b[0m \u001b[31m7.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading Shimmy-0.2.1-py3-none-any.whl (25 kB)\n","Downloading ale_py-0.8.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.7 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.7/1.7 MB\u001b[0m \u001b[31m68.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hBuilding wheels for collected packages: antlr4-python3-runtime, AutoROM.accept-rom-license\n","  Building wheel for antlr4-python3-runtime (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for antlr4-python3-runtime: filename=antlr4_python3_runtime-4.9.3-py3-none-any.whl size=144555 sha256=baadebb667d22accce52a53f636643489abb3e8dfe483726724eaba532613c59\n","  Stored in directory: /root/.cache/pip/wheels/12/93/dd/1f6a127edc45659556564c5730f6d4e300888f4bca2d4c5a88\n","  Building wheel for AutoROM.accept-rom-license (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for AutoROM.accept-rom-license: filename=AutoROM.accept_rom_license-0.6.1-py3-none-any.whl size=446667 sha256=6cdfe24a1123bdb39179eae969035cd1a43f45fb4839ce29bb66d54dbede496c\n","  Stored in directory: /root/.cache/pip/wheels/6b/1b/ef/a43ff1a2f1736d5711faa1ba4c1f61be1131b8899e6a057811\n","Successfully built antlr4-python3-runtime AutoROM.accept-rom-license\n","Installing collected packages: farama-notifications, antlr4-python3-runtime, tqdm, torcheval, pygame, pillow, omegaconf, numpy, hydra-core, huggingface-hub, h5py, gymnasium, AutoROM.accept-rom-license, autorom, ale-py, wandb, shimmy\n","  Attempting uninstall: tqdm\n","    Found existing installation: tqdm 4.66.6\n","    Uninstalling tqdm-4.66.6:\n","      Successfully uninstalled tqdm-4.66.6\n","  Attempting uninstall: pygame\n","    Found existing installation: pygame 2.6.1\n","    Uninstalling pygame-2.6.1:\n","      Successfully uninstalled pygame-2.6.1\n","  Attempting uninstall: pillow\n","    Found existing installation: pillow 11.0.0\n","    Uninstalling pillow-11.0.0:\n","      Successfully uninstalled pillow-11.0.0\n","  Attempting uninstall: numpy\n","    Found existing installation: numpy 1.26.4\n","    Uninstalling numpy-1.26.4:\n","      Successfully uninstalled numpy-1.26.4\n","  Attempting uninstall: huggingface-hub\n","    Found existing installation: huggingface-hub 0.26.2\n","    Uninstalling huggingface-hub-0.26.2:\n","      Successfully uninstalled huggingface-hub-0.26.2\n","  Attempting uninstall: h5py\n","    Found existing installation: h5py 3.12.1\n","    Uninstalling h5py-3.12.1:\n","      Successfully uninstalled h5py-3.12.1\n","  Attempting uninstall: wandb\n","    Found existing installation: wandb 0.18.7\n","    Uninstalling wandb-0.18.7:\n","      Successfully uninstalled wandb-0.18.7\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","accelerate 1.1.1 requires huggingface-hub>=0.21.0, but you have huggingface-hub 0.17.2 which is incompatible.\n","diffusers 0.31.0 requires huggingface-hub>=0.23.2, but you have huggingface-hub 0.17.2 which is incompatible.\n","sentence-transformers 3.2.1 requires huggingface-hub>=0.20.0, but you have huggingface-hub 0.17.2 which is incompatible.\n","transformers 4.46.2 requires huggingface-hub<1.0,>=0.23.2, but you have huggingface-hub 0.17.2 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed AutoROM.accept-rom-license-0.6.1 ale-py-0.8.1 antlr4-python3-runtime-4.9.3 autorom-0.4.2 farama-notifications-0.0.4 gymnasium-0.29.1 h5py-3.11.0 huggingface-hub-0.17.2 hydra-core-1.3.0 numpy-1.26.0 omegaconf-2.3.0 pillow-10.3.0 pygame-2.5.2 shimmy-0.2.1 torcheval-0.0.7 tqdm-4.66.4 wandb-0.17.0\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["PIL","pydevd_plugins"]},"id":"220702d37d6b4c27b262f4e8b9626b0a"}},"metadata":{}}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":230,"status":"ok","timestamp":1732440528804,"user":{"displayName":"Dere","userId":"05435981219959557895"},"user_tz":-60},"id":"i0vK4dJP0bxY","outputId":"8d5f4442-7925-4b31-bf4d-aa4962e90a4a"},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06\n"]}],"source":["cd /content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":248,"status":"ok","timestamp":1732440530080,"user":{"displayName":"Dere","userId":"05435981219959557895"},"user_tz":-60},"id":"AuaRb16G062T","outputId":"c1ce224a-31ec-4e91-c7c9-a364694dd2c8"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[0m\u001b[01;34mcheckpoints\u001b[0m/  \u001b[01;34mconfig\u001b[0m/  main.log  \u001b[01;34mscripts\u001b[0m/  \u001b[01;34msrc\u001b[0m/  \u001b[01;34mwandb\u001b[0m/\n"]}],"source":["ls"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MCnzjJbM1HKO"},"outputs":[],"source":["!chmod +x scripts/resume.sh"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_MWpkP2m1OO2","outputId":"ddb201bc-5993-47ca-b2aa-9abb1970f9fc","executionInfo":{"status":"ok","timestamp":1732442255223,"user_tz":-60,"elapsed":1687753,"user":{"displayName":"Dere","userId":"05435981219959557895"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["--- DENOISER ---\n","DENOISER Grad acc steps: 4\n","DENOISER batch size: 28\n","--- UPSAMPLER ---\n","UPSAMPLER Grad acc steps: 1\n","UPSAMPLER batch size: 4\n","path_data_low_res: [default: /content/drive/MyDrive/AI-MarioKart64/diamond/processed/low_res]\n","/content/drive/MyDrive/AI-MarioKart64/diamond/processed/low_res\n","path_data_full_res: [default: /content/drive/MyDrive/AI-MarioKart64/diamond/processed/full_res]\n","/content/drive/MyDrive/AI-MarioKart64/diamond/processed/full_res\n","Starting on cuda:0\n","/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/dataset.py:155: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  self.load_state_dict(torch.load(self._default_path))\n","/usr/local/lib/python3.10/dist-packages/torch/utils/data/sampler.py:76: UserWarning: `data_source` argument is not used and will be removed in 2.2.0.You may still have custom implementation that utilizes it.\n","  warnings.warn(\n","/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/trainer.py:439: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  self.load_state_dict(torch.load(self._path_state_ckpt, map_location=self._device))\n","330483075 parameters in denoiser\n","51149187 parameters in upsampler\n","train_dataset: 243 episodes, 243000 steps.\n","test_dataset: 19 episodes, 19000 steps.\n","\n","Epoch 21 / 1500\n","\n","/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/episode.py:41: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  for k, v in torch.load(Path(path), map_location=map_location).items()\n","/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/episode.py:41: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  for k, v in torch.load(Path(path), map_location=map_location).items()\n","Training denoiser:   0% 0/400 [00:00<?, ?it/s]/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/episode.py:41: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  for k, v in torch.load(Path(path), map_location=map_location).items()\n","/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/episode.py:41: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  for k, v in torch.load(Path(path), map_location=map_location).items()\n","Training denoiser: 100% 400/400 [21:02<00:00,  3.16s/it]\n","Training upsampler:   0% 0/400 [00:00<?, ?it/s]/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/episode.py:41: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  for k, v in torch.load(Path(path), map_location=map_location).items()\n","/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/episode.py:41: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  for k, v in torch.load(Path(path), map_location=map_location).items()\n","/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/episode.py:41: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  for k, v in torch.load(Path(path), map_location=map_location).items()\n","/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/episode.py:41: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  for k, v in torch.load(Path(path), map_location=map_location).items()\n","Training upsampler: 100% 400/400 [03:07<00:00,  2.13it/s]\n","\n","Epoch 22 / 1500\n","\n","Training denoiser:   7% 28/400 [02:23<31:40,  5.11s/it]\n","Error executing job with overrides: ['common.resume=True']\n","Traceback (most recent call last):\n","  File \"/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/main.py\", line 43, in main\n","    run(cfg, root_dir)\n","  File \"/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/utils.py\", line 304, in inner\n","    func(*args, **kwargs)\n","  File \"/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/main.py\", line 57, in run\n","    trainer.run()\n","  File \"/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/trainer.py\", line 271, in run\n","    to_log += self.train_agent()\n","  File \"/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/trainer.py\", line 364, in train_agent\n","    to_log += self.train_component(name, steps)\n","  File \"/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/trainer.py\", line 394, in train_component\n","    batch = next(data_iterator).to(self._device) if data_iterator is not None else None\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py\", line 701, in __next__\n","    data = self._next_data()\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py\", line 1445, in _next_data\n","    return self._process_data(data)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py\", line 1491, in _process_data\n","    data.reraise()\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/_utils.py\", line 715, in reraise\n","    raise exception\n","KeyError: Caught KeyError in DataLoader worker process 0.\n","Original Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/worker.py\", line 351, in _worker_loop\n","    data = fetcher.fetch(index)  # type: ignore[possibly-undefined]\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py\", line 52, in fetch\n","    data = [self.dataset[idx] for idx in possibly_batched_index]\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/utils/data/_utils/fetch.py\", line 52, in <listcomp>\n","    data = [self.dataset[idx] for idx in possibly_batched_index]\n","  File \"/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/dataset.py\", line 58, in __getitem__\n","    segment.info[\"full_res\"] = self._dataset_full_res[segment_id_full_res].obs\n","  File \"/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/dataset.py\", line 184, in __getitem__\n","    obs = torch.stack([torch.tensor(f[f\"frame_{i}_x\"][:]).flip(2).permute(2, 0, 1).div(255).mul(2).sub(1) for i in range(start, stop)])\n","  File \"/content/drive/MyDrive/AI-MarioKart64/diamond/outputs/2024-11-22/19-42-06/src/data/dataset.py\", line 184, in <listcomp>\n","    obs = torch.stack([torch.tensor(f[f\"frame_{i}_x\"][:]).flip(2).permute(2, 0, 1).div(255).mul(2).sub(1) for i in range(start, stop)])\n","  File \"h5py/_objects.pyx\", line 54, in h5py._objects.with_phil.wrapper\n","  File \"h5py/_objects.pyx\", line 55, in h5py._objects.with_phil.wrapper\n","  File \"/usr/local/lib/python3.10/dist-packages/h5py/_hl/group.py\", line 357, in __getitem__\n","    oid = h5o.open(self.id, self._e(name), lapl=self._lapl)\n","  File \"h5py/_objects.pyx\", line 54, in h5py._objects.with_phil.wrapper\n","  File \"h5py/_objects.pyx\", line 55, in h5py._objects.with_phil.wrapper\n","  File \"h5py/h5o.pyx\", line 241, in h5py.h5o.open\n","KeyError: \"Unable to synchronously open object (file read failed: time = Sun Nov 24 09:56:49 2024\\n, filename = '/content/drive/MyDrive/AI-MarioKart64/diamond/processed/full_res/MMF_noised_noised_21-11-2024-17-19-40_41.hdf5', file descriptor = 46, errno = 5, error message = 'Input/output error', buf = 0x59fe3a18bcc0, total read size = 544, bytes this sub-read = 544, bytes actually read = 18446744073709551615, offset = 0)\"\n","\n","\n","Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.\n"]}],"source":["!scripts/resume.sh"]},{"cell_type":"code","source":["import time\n","from google.colab import runtime\n","\n","# Set a delay in seconds (e.g., 10 seconds)\n","time.sleep(10)\n","\n","# Disconnect the runtime\n","runtime.unassign()\n"],"metadata":{"id":"IITBjQ03gY-5"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Generating Spawns"],"metadata":{"id":"zujSedAeiRZ_"}},{"cell_type":"code","source":["cd /content/drive/MyDrive/AI-MarioKart64/diamond"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yROdyLB0iXu3","executionInfo":{"status":"ok","timestamp":1732642578984,"user_tz":-60,"elapsed":360,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"406bf725-c332-4ec4-8f14-7d39d7da2bd4"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/AI-MarioKart64/diamond\n"]}]},{"cell_type":"code","source":["!pip install -r requirements.txt"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"PKJVDzB4ipmv","executionInfo":{"status":"ok","timestamp":1732642570059,"user_tz":-60,"elapsed":34437,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"50155761-33fb-40ac-ab3e-eba017c1cb32"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting gymnasium==0.29.1 (from gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading gymnasium-0.29.1-py3-none-any.whl.metadata (10 kB)\n","Collecting h5py==3.11.0 (from -r requirements.txt (line 2))\n","  Downloading h5py-3.11.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.5 kB)\n","Collecting huggingface-hub==0.17.2 (from -r requirements.txt (line 3))\n","  Downloading huggingface_hub-0.17.2-py3-none-any.whl.metadata (13 kB)\n","Collecting hydra-core==1.3 (from -r requirements.txt (line 4))\n","  Downloading hydra_core-1.3.0-py3-none-any.whl.metadata (4.8 kB)\n","Collecting numpy==1.26.0 (from -r requirements.txt (line 5))\n","  Downloading numpy-1.26.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (58 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.5/58.5 kB\u001b[0m \u001b[31m2.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: opencv-python==4.10.0.84 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 6)) (4.10.0.84)\n","Collecting pillow==10.3.0 (from -r requirements.txt (line 7))\n","  Downloading pillow-10.3.0-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (9.2 kB)\n","Collecting pygame==2.5.2 (from -r requirements.txt (line 8))\n","  Downloading pygame-2.5.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (13 kB)\n","Collecting torcheval==0.0.7 (from -r requirements.txt (line 9))\n","  Downloading torcheval-0.0.7-py3-none-any.whl.metadata (8.6 kB)\n","Collecting tqdm==4.66.4 (from -r requirements.txt (line 10))\n","  Downloading tqdm-4.66.4-py3-none-any.whl.metadata (57 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m57.6/57.6 kB\u001b[0m \u001b[31m4.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting wandb==0.17.0 (from -r requirements.txt (line 11))\n","  Downloading wandb-0.17.0-py3-none-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (10 kB)\n","Requirement already satisfied: cloudpickle>=1.2.0 in /usr/local/lib/python3.10/dist-packages (from gymnasium==0.29.1->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1)) (3.1.0)\n","Requirement already satisfied: typing-extensions>=4.3.0 in /usr/local/lib/python3.10/dist-packages (from gymnasium==0.29.1->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1)) (4.12.2)\n","Collecting farama-notifications>=0.0.1 (from gymnasium==0.29.1->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading Farama_Notifications-0.0.4-py3-none-any.whl.metadata (558 bytes)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (3.16.1)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (2024.10.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (2.32.3)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (6.0.2)\n","Requirement already satisfied: packaging>=20.9 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub==0.17.2->-r requirements.txt (line 3)) (24.2)\n","Collecting omegaconf~=2.2 (from hydra-core==1.3->-r requirements.txt (line 4))\n","  Downloading omegaconf-2.3.0-py3-none-any.whl.metadata (3.9 kB)\n","Collecting antlr4-python3-runtime==4.9.* (from hydra-core==1.3->-r requirements.txt (line 4))\n","  Downloading antlr4-python3-runtime-4.9.3.tar.gz (117 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m117.0/117.0 kB\u001b[0m \u001b[31m8.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: click!=8.0.0,>=7.1 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (8.1.7)\n","Requirement already satisfied: docker-pycreds>=0.4.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (0.4.0)\n","Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (3.1.43)\n","Requirement already satisfied: platformdirs in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (4.3.6)\n","Requirement already satisfied: protobuf!=4.21.0,<5,>=3.19.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (4.25.5)\n","Requirement already satisfied: psutil>=5.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (5.9.5)\n","Requirement already satisfied: sentry-sdk>=1.0.0 in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (2.18.0)\n","Requirement already satisfied: setproctitle in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (1.3.4)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from wandb==0.17.0->-r requirements.txt (line 11)) (75.1.0)\n","Collecting shimmy<1.0,>=0.1.0 (from shimmy[atari]<1.0,>=0.1.0; extra == \"atari\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading Shimmy-0.2.1-py3-none-any.whl.metadata (2.3 kB)\n","Collecting autorom~=0.4.2 (from autorom[accept-rom-license]~=0.4.2; extra == \"accept-rom-license\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading AutoROM-0.4.2-py3-none-any.whl.metadata (2.8 kB)\n","Collecting AutoROM.accept-rom-license (from autorom[accept-rom-license]~=0.4.2; extra == \"accept-rom-license\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading AutoROM.accept-rom-license-0.6.1.tar.gz (434 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m434.7/434.7 kB\u001b[0m \u001b[31m11.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: six>=1.4.0 in /usr/local/lib/python3.10/dist-packages (from docker-pycreds>=0.4.0->wandb==0.17.0->-r requirements.txt (line 11)) (1.16.0)\n","Requirement already satisfied: gitdb<5,>=4.0.1 in /usr/local/lib/python3.10/dist-packages (from gitpython!=3.1.29,>=1.0.0->wandb==0.17.0->-r requirements.txt (line 11)) (4.0.11)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub==0.17.2->-r requirements.txt (line 3)) (3.4.0)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub==0.17.2->-r requirements.txt (line 3)) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub==0.17.2->-r requirements.txt (line 3)) (2.2.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub==0.17.2->-r requirements.txt (line 3)) (2024.8.30)\n","Collecting ale-py~=0.8.1 (from shimmy[atari]<1.0,>=0.1.0; extra == \"atari\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1))\n","  Downloading ale_py-0.8.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.1 kB)\n","Requirement already satisfied: importlib-resources in /usr/local/lib/python3.10/dist-packages (from ale-py~=0.8.1->shimmy[atari]<1.0,>=0.1.0; extra == \"atari\"->gymnasium[accept-rom-license,atari]==0.29.1->-r requirements.txt (line 1)) (6.4.5)\n","Requirement already satisfied: smmap<6,>=3.0.1 in /usr/local/lib/python3.10/dist-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb==0.17.0->-r requirements.txt (line 11)) (5.0.1)\n","Downloading gymnasium-0.29.1-py3-none-any.whl (953 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m953.9/953.9 kB\u001b[0m \u001b[31m33.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading h5py-3.11.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.3 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m5.3/5.3 MB\u001b[0m \u001b[31m104.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading huggingface_hub-0.17.2-py3-none-any.whl (294 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m294.9/294.9 kB\u001b[0m \u001b[31m21.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading hydra_core-1.3.0-py3-none-any.whl (153 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m153.8/153.8 kB\u001b[0m \u001b[31m11.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading numpy-1.26.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.2 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m18.2/18.2 MB\u001b[0m \u001b[31m106.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pillow-10.3.0-cp310-cp310-manylinux_2_28_x86_64.whl (4.5 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m4.5/4.5 MB\u001b[0m \u001b[31m109.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pygame-2.5.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (14.0 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m14.0/14.0 MB\u001b[0m \u001b[31m6.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading torcheval-0.0.7-py3-none-any.whl (179 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m179.2/179.2 kB\u001b[0m \u001b[31m14.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading tqdm-4.66.4-py3-none-any.whl (78 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m78.3/78.3 kB\u001b[0m \u001b[31m6.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading wandb-0.17.0-py3-none-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (6.7 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6.7/6.7 MB\u001b[0m \u001b[31m11.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading AutoROM-0.4.2-py3-none-any.whl (16 kB)\n","Using cached Farama_Notifications-0.0.4-py3-none-any.whl (2.5 kB)\n","Downloading omegaconf-2.3.0-py3-none-any.whl (79 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m79.5/79.5 kB\u001b[0m \u001b[31m5.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading Shimmy-0.2.1-py3-none-any.whl (25 kB)\n","Downloading ale_py-0.8.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.7 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.7/1.7 MB\u001b[0m \u001b[31m63.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hBuilding wheels for collected packages: antlr4-python3-runtime, AutoROM.accept-rom-license\n","  Building wheel for antlr4-python3-runtime (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for antlr4-python3-runtime: filename=antlr4_python3_runtime-4.9.3-py3-none-any.whl size=144555 sha256=2521d211846bb587746d1449368e782a102afb83272d2f4c2e6290e3dd92d50b\n","  Stored in directory: /root/.cache/pip/wheels/12/93/dd/1f6a127edc45659556564c5730f6d4e300888f4bca2d4c5a88\n","  Building wheel for AutoROM.accept-rom-license (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for AutoROM.accept-rom-license: filename=AutoROM.accept_rom_license-0.6.1-py3-none-any.whl size=446667 sha256=f92ea52eef7f972f6f3b33847d008b5238cd87f279b8c2cc094c7c094038e5eb\n","  Stored in directory: /root/.cache/pip/wheels/6b/1b/ef/a43ff1a2f1736d5711faa1ba4c1f61be1131b8899e6a057811\n","Successfully built antlr4-python3-runtime AutoROM.accept-rom-license\n","Installing collected packages: farama-notifications, antlr4-python3-runtime, tqdm, torcheval, pygame, pillow, omegaconf, numpy, hydra-core, huggingface-hub, h5py, gymnasium, AutoROM.accept-rom-license, autorom, ale-py, wandb, shimmy\n","  Attempting uninstall: tqdm\n","    Found existing installation: tqdm 4.66.6\n","    Uninstalling tqdm-4.66.6:\n","      Successfully uninstalled tqdm-4.66.6\n","  Attempting uninstall: pygame\n","    Found existing installation: pygame 2.6.1\n","    Uninstalling pygame-2.6.1:\n","      Successfully uninstalled pygame-2.6.1\n","  Attempting uninstall: pillow\n","    Found existing installation: pillow 11.0.0\n","    Uninstalling pillow-11.0.0:\n","      Successfully uninstalled pillow-11.0.0\n","  Attempting uninstall: numpy\n","    Found existing installation: numpy 1.26.4\n","    Uninstalling numpy-1.26.4:\n","      Successfully uninstalled numpy-1.26.4\n","  Attempting uninstall: huggingface-hub\n","    Found existing installation: huggingface-hub 0.26.2\n","    Uninstalling huggingface-hub-0.26.2:\n","      Successfully uninstalled huggingface-hub-0.26.2\n","  Attempting uninstall: h5py\n","    Found existing installation: h5py 3.12.1\n","    Uninstalling h5py-3.12.1:\n","      Successfully uninstalled h5py-3.12.1\n","  Attempting uninstall: wandb\n","    Found existing installation: wandb 0.18.7\n","    Uninstalling wandb-0.18.7:\n","      Successfully uninstalled wandb-0.18.7\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","accelerate 1.1.1 requires huggingface-hub>=0.21.0, but you have huggingface-hub 0.17.2 which is incompatible.\n","diffusers 0.31.0 requires huggingface-hub>=0.23.2, but you have huggingface-hub 0.17.2 which is incompatible.\n","sentence-transformers 3.2.1 requires huggingface-hub>=0.20.0, but you have huggingface-hub 0.17.2 which is incompatible.\n","transformers 4.46.2 requires huggingface-hub<1.0,>=0.23.2, but you have huggingface-hub 0.17.2 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed AutoROM.accept-rom-license-0.6.1 ale-py-0.8.1 antlr4-python3-runtime-4.9.3 autorom-0.4.2 farama-notifications-0.0.4 gymnasium-0.29.1 h5py-3.11.0 huggingface-hub-0.17.2 hydra-core-1.3.0 numpy-1.26.0 omegaconf-2.3.0 pillow-10.3.0 pygame-2.5.2 shimmy-0.2.1 torcheval-0.0.7 tqdm-4.66.4 wandb-0.17.0\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["PIL","pydevd_plugins"]},"id":"f5a3d95e6aae4af59d5e04aeec220eef"}},"metadata":{}}]},{"cell_type":"code","source":["!mkdir ./trained/\n","!mkdir ./trained/csgo/\n","!mkdir ./trained/csgo/spawn"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"F6sY8rpRizTe","executionInfo":{"status":"ok","timestamp":1732642655611,"user_tz":-60,"elapsed":482,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"4e6da883-93a0-4b15-bb22-26709eb120b7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["mkdir: cannot create directory ‘./trained/’: File exists\n","mkdir: cannot create directory ‘./trained/csgo/’: File exists\n"]}]},{"cell_type":"code","source":["!python src/spawn.py ./processed/full_res/ ./trained/"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jVtNYf0eiamH","executionInfo":{"status":"ok","timestamp":1732642898120,"user_tz":-60,"elapsed":5575,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"feb132d2-0d6c-4831-a355-48f929929864"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["0: [0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0]\n","1: [0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0]\n","2: [0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0]\n","3: [0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0]\n","Saving act.npy of size (4, 22)\n","Saving full_res.npy of size (4, 3, 240, 320)\n","Saving next_act.npy of size (200, 22)\n","Saving low_res.npy of size (4, 3, 48, 64)\n"]}]},{"cell_type":"code","source":["!tar -czvf trained.tar.gz trained\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"T7AzoszhkI2P","executionInfo":{"status":"ok","timestamp":1732642999042,"user_tz":-60,"elapsed":834,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"58c34f1b-4f49-4258-bed7-ffb48146fde9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["./trained/\n","./trained/csgo/\n","./trained/csgo/spawn/\n","./trained/csgo/spawn/0/\n","./trained/csgo/spawn/0/full_res_0.png\n","tar: ./trained/csgo/spawn/0/full_res_0.png: file changed as we read it\n","./trained/csgo/spawn/0/full_res_1.png\n","tar: ./trained/csgo/spawn/0/full_res_1.png: file changed as we read it\n","./trained/csgo/spawn/0/full_res_2.png\n","tar: ./trained/csgo/spawn/0/full_res_2.png: file changed as we read it\n","./trained/csgo/spawn/0/full_res_3.png\n","tar: ./trained/csgo/spawn/0/full_res_3.png: file changed as we read it\n","./trained/csgo/spawn/0/act.npy\n","tar: ./trained/csgo/spawn/0/act.npy: file changed as we read it\n","./trained/csgo/spawn/0/full_res.npy\n","tar: ./trained/csgo/spawn/0/full_res.npy: file changed as we read it\n","./trained/csgo/spawn/0/next_act.npy\n","tar: ./trained/csgo/spawn/0/next_act.npy: file changed as we read it\n","./trained/csgo/spawn/0/low_res.npy\n","tar: ./trained/csgo/spawn/0/low_res.npy: file changed as we read it\n","./trained/csgo/spawn/1/\n","./trained/csgo/spawn/1/full_res_0.png\n","tar: ./trained/csgo/spawn/1/full_res_0.png: file changed as we read it\n","./trained/csgo/spawn/1/full_res_1.png\n","tar: ./trained/csgo/spawn/1/full_res_1.png: file changed as we read it\n","./trained/csgo/spawn/1/full_res_2.png\n","tar: ./trained/csgo/spawn/1/full_res_2.png: file changed as we read it\n","./trained/csgo/spawn/1/full_res_3.png\n","tar: ./trained/csgo/spawn/1/full_res_3.png: file changed as we read it\n","./trained/csgo/spawn/1/act.npy\n","tar: ./trained/csgo/spawn/1/act.npy: file changed as we read it\n","./trained/csgo/spawn/1/full_res.npy\n","tar: ./trained/csgo/spawn/1/full_res.npy: file changed as we read it\n","./trained/csgo/spawn/1/next_act.npy\n","tar: ./trained/csgo/spawn/1/next_act.npy: file changed as we read it\n","./trained/csgo/spawn/1/low_res.npy\n","tar: ./trained/csgo/spawn/1/low_res.npy: file changed as we read it\n","./trained/csgo/spawn/2/\n","./trained/csgo/spawn/2/full_res_0.png\n","tar: ./trained/csgo/spawn/2/full_res_0.png: file changed as we read it\n","./trained/csgo/spawn/2/full_res_1.png\n","tar: ./trained/csgo/spawn/2/full_res_1.png: file changed as we read it\n","./trained/csgo/spawn/2/full_res_2.png\n","tar: ./trained/csgo/spawn/2/full_res_2.png: file changed as we read it\n","./trained/csgo/spawn/2/full_res_3.png\n","tar: ./trained/csgo/spawn/2/full_res_3.png: file changed as we read it\n","./trained/csgo/spawn/2/act.npy\n","tar: ./trained/csgo/spawn/2/act.npy: file changed as we read it\n","./trained/csgo/spawn/2/full_res.npy\n","tar: ./trained/csgo/spawn/2/full_res.npy: file changed as we read it\n","./trained/csgo/spawn/2/next_act.npy\n","tar: ./trained/csgo/spawn/2/next_act.npy: file changed as we read it\n","./trained/csgo/spawn/2/low_res.npy\n","tar: ./trained/csgo/spawn/2/low_res.npy: file changed as we read it\n","./trained/csgo/spawn/3/\n","./trained/csgo/spawn/3/full_res_0.png\n","tar: ./trained/csgo/spawn/3/full_res_0.png: file changed as we read it\n","./trained/csgo/spawn/3/full_res_1.png\n","tar: ./trained/csgo/spawn/3/full_res_1.png: file changed as we read it\n","./trained/csgo/spawn/3/full_res_2.png\n","tar: ./trained/csgo/spawn/3/full_res_2.png: file changed as we read it\n","./trained/csgo/spawn/3/full_res_3.png\n","tar: ./trained/csgo/spawn/3/full_res_3.png: file changed as we read it\n","./trained/csgo/spawn/3/act.npy\n","tar: ./trained/csgo/spawn/3/act.npy: file changed as we read it\n","./trained/csgo/spawn/3/full_res.npy\n","tar: ./trained/csgo/spawn/3/full_res.npy: file changed as we read it\n","./trained/csgo/spawn/3/next_act.npy\n","tar: ./trained/csgo/spawn/3/next_act.npy: file changed as we read it\n","./trained/csgo/spawn/3/low_res.npy\n","tar: ./trained/csgo/spawn/3/low_res.npy: file changed as we read it\n","./trained/csgo/spawn/4/\n","./trained/csgo/spawn/4/full_res_0.png\n","tar: ./trained/csgo/spawn/4/full_res_0.png: file changed as we read it\n","./trained/csgo/spawn/4/full_res_1.png\n","tar: ./trained/csgo/spawn/4/full_res_1.png: file changed as we read it\n","./trained/csgo/spawn/4/full_res_2.png\n","tar: ./trained/csgo/spawn/4/full_res_2.png: file changed as we read it\n","./trained/csgo/spawn/4/full_res_3.png\n","tar: ./trained/csgo/spawn/4/full_res_3.png: file changed as we read it\n","./trained/csgo/spawn/4/act.npy\n","tar: ./trained/csgo/spawn/4/act.npy: file changed as we read it\n","./trained/csgo/spawn/4/full_res.npy\n","tar: ./trained/csgo/spawn/4/full_res.npy: file changed as we read it\n","./trained/csgo/spawn/4/next_act.npy\n","tar: ./trained/csgo/spawn/4/next_act.npy: file changed as we read it\n","./trained/csgo/spawn/4/low_res.npy\n","tar: ./trained/csgo/spawn/4/low_res.npy: file changed as we read it\n","./trained/csgo/spawn/5/\n","./trained/csgo/spawn/5/full_res_0.png\n","tar: ./trained/csgo/spawn/5/full_res_0.png: file changed as we read it\n","./trained/csgo/spawn/5/full_res_1.png\n","tar: ./trained/csgo/spawn/5/full_res_1.png: file changed as we read it\n","./trained/csgo/spawn/5/full_res_2.png\n","tar: ./trained/csgo/spawn/5/full_res_2.png: file changed as we read it\n","./trained/csgo/spawn/5/full_res_3.png\n","tar: ./trained/csgo/spawn/5/full_res_3.png: file changed as we read it\n","./trained/csgo/spawn/5/act.npy\n","tar: ./trained/csgo/spawn/5/act.npy: file changed as we read it\n","./trained/csgo/spawn/5/full_res.npy\n","tar: ./trained/csgo/spawn/5/full_res.npy: file changed as we read it\n","./trained/csgo/spawn/5/next_act.npy\n","tar: ./trained/csgo/spawn/5/next_act.npy: file changed as we read it\n","./trained/csgo/spawn/5/low_res.npy\n","tar: ./trained/csgo/spawn/5/low_res.npy: file changed as we read it\n","./trained/csgo/spawn/6/\n","./trained/csgo/spawn/6/full_res_0.png\n","tar: ./trained/csgo/spawn/6/full_res_0.png: file changed as we read it\n","./trained/csgo/spawn/6/full_res_1.png\n","tar: ./trained/csgo/spawn/6/full_res_1.png: file changed as we read it\n","./trained/csgo/spawn/6/full_res_2.png\n","tar: ./trained/csgo/spawn/6/full_res_2.png: file changed as we read it\n","./trained/csgo/spawn/6/full_res_3.png\n","tar: ./trained/csgo/spawn/6/full_res_3.png: file changed as we read it\n","./trained/csgo/spawn/6/act.npy\n","tar: ./trained/csgo/spawn/6/act.npy: file changed as we read it\n","./trained/csgo/spawn/6/full_res.npy\n","tar: ./trained/csgo/spawn/6/full_res.npy: file changed as we read it\n","./trained/csgo/spawn/6/next_act.npy\n","tar: ./trained/csgo/spawn/6/next_act.npy: file changed as we read it\n","./trained/csgo/spawn/6/low_res.npy\n","tar: ./trained/csgo/spawn/6/low_res.npy: file changed as we read it\n","./trained/csgo/spawn/7/\n","./trained/csgo/spawn/7/full_res_0.png\n","tar: ./trained/csgo/spawn/7/full_res_0.png: file changed as we read it\n","./trained/csgo/spawn/7/full_res_1.png\n","tar: ./trained/csgo/spawn/7/full_res_1.png: file changed as we read it\n","./trained/csgo/spawn/7/full_res_2.png\n","tar: ./trained/csgo/spawn/7/full_res_2.png: file changed as we read it\n","./trained/csgo/spawn/7/full_res_3.png\n","tar: ./trained/csgo/spawn/7/full_res_3.png: file changed as we read it\n","./trained/csgo/spawn/7/act.npy\n","tar: ./trained/csgo/spawn/7/act.npy: file changed as we read it\n","./trained/csgo/spawn/7/full_res.npy\n","tar: ./trained/csgo/spawn/7/full_res.npy: file changed as we read it\n","./trained/csgo/spawn/7/next_act.npy\n","tar: ./trained/csgo/spawn/7/next_act.npy: file changed as we read it\n","./trained/csgo/spawn/7/low_res.npy\n","tar: ./trained/csgo/spawn/7/low_res.npy: file changed as we read it\n"]}]},{"cell_type":"markdown","metadata":{"id":"5aejIQTi2rde"},"source":["# Running the model\n","- Run the play.py script, press enter. Inputs WILL NOT WORK on colab."]},{"cell_type":"code","source":["cd /content/drive/MyDrive/colab-diamond-csgo"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-pRXDwp89wpK","executionInfo":{"status":"ok","timestamp":1732282737024,"user_tz":-60,"elapsed":359,"user":{"displayName":"Dere","userId":"05435981219959557895"}},"outputId":"a41aa9f3-0cd5-4c80-90c7-1c3e7f02af58"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/colab-diamond-csgo\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":393,"referenced_widgets":["ce345bec136e436abf5c39f4b36e711d","670c8db2350d4a69b6455c7fff335c2f","ae7b118b01f1449c9bfdd6c616bf37c8","694bc9fbf4a7439685a18f0d28a137d6","ee5b048fcca64c718a4b438b64cdafed","0893d6990404416ea5b1c9919503215a","8ac7ecf0df80494792b524a944545958","f476eaa2f32f47e5a2c19d8bd7cd677f","ff246f3910fd4bf5a4232c8ae71908da","b1a230deb77649eb8bd5c6570edae081","0a431ead78854609abccae1e3a8a3b75","615676846859429780644f7d9e0e0aed","618752a82afb4ae0bfd7c49d064ee8d1","9e24233b58cb4bbfb2ad7ad40d287b5b","a0eecb1a9ada47fbb8ee2b6c2821d185","79696bcfa84b4fd1b473b4e71f49102b","732b3164e2a4477fadcbd2f9dea93273","48675cae40804c06ba3b18222de8973b","75a4486ff976488b9a3c02a442830600"]},"executionInfo":{"elapsed":16978,"status":"ok","timestamp":1732282754001,"user":{"displayName":"Dere","userId":"05435981219959557895"},"user_tz":-60},"id":"DJnMk9LQsncP","outputId":"8d513d6f-d04a-45f0-89cb-f7e59208d18a"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/wandb/analytics/sentry.py:90: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x\n","  self.hub = sentry_sdk.Hub(client)\n"]},{"output_type":"stream","name":"stdout","text":["{'wandb': {'mode': 'disabled', 'project': None, 'entity': None, 'name': None, 'group': None, 'tags': None, 'notes': None}, 'initialization': {'path_to_ckpt': None, 'load_denoiser': True, 'load_rew_end_model': True, 'load_actor_critic': True}, 'common': {'devices': 'all', 'seed': None, 'resume': False}, 'checkpointing': {'save_agent_every': 5, 'num_to_keep': 11}, 'collection': {'train': {'num_envs': 1, 'epsilon': 0.01, 'num_steps_total': 100000, 'first_epoch': {'min': 5000, 'max': 10000, 'threshold_rew': 10}, 'steps_per_epoch': 100}, 'test': {'num_envs': 1, 'num_episodes': 4, 'epsilon': 0.0, 'num_final_episodes': 100}}, 'static_dataset': {'path': '${env.path_data_low_res}', 'ignore_sample_weights': True}, 'training': {'should': True, 'num_final_epochs': 1500, 'cache_in_ram': False, 'num_workers_data_loaders': 4, 'model_free': False, 'compile_wm': False}, 'evaluation': {'should': True, 'every': 20}, 'denoiser': {'training': {'num_autoregressive_steps': 4, 'start_after_epochs': 0, 'steps_first_epoch': 100, 'steps_per_epoch': 100, 'sample_weights': None, 'batch_size': 14, 'grad_acc_steps': 1, 'lr_warmup_steps': 100, 'max_grad_norm': 10.0}, 'optimizer': {'lr': 0.0001, 'weight_decay': 0.01, 'eps': 1e-08}, 'sigma_distribution': {'_target_': 'models.diffusion.SigmaDistributionConfig', 'loc': -1.2, 'scale': 1.2, 'sigma_min': 0.002, 'sigma_max': 20}}, 'upsampler': {'training': {'num_autoregressive_steps': 1, 'start_after_epochs': 0, 'steps_first_epoch': 400, 'steps_per_epoch': 400, 'sample_weights': None, 'batch_size': 14, 'grad_acc_steps': 1, 'lr_warmup_steps': 100, 'max_grad_norm': 10.0}, 'optimizer': '${denoiser.optimizer}', 'sigma_distribution': '${denoiser.sigma_distribution}'}, 'env': {'train': {'id': 'csgo', 'size': [320, 240]}, 'num_actions': 20, 'path_data_low_res': '/content/drive/MyDrive/colab-diamond-csgo/processed/low_res', 'path_data_full_res': '/content/drive/MyDrive/colab-diamond-csgo/processed/full_res', 'keymap': 'csgo'}, 'agent': {'_target_': 'agent.AgentConfig', 'denoiser': {'_target_': 'models.diffusion.DenoiserConfig', 'sigma_data': 0.5, 'sigma_offset_noise': 0.1, 'noise_previous_obs': True, 'upsampling_factor': None, 'inner_model': {'_target_': 'models.diffusion.InnerModelConfig', 'img_channels': 3, 'num_steps_conditioning': 4, 'cond_channels': 2048, 'depths': [2, 2, 2, 2], 'channels': [128, 256, 512, 1024], 'attn_depths': [0, 0, 1, 1]}}, 'upsampler': {'_target_': 'models.diffusion.DenoiserConfig', 'sigma_data': 0.5, 'sigma_offset_noise': 0.1, 'noise_previous_obs': False, 'upsampling_factor': 5, 'inner_model': {'_target_': 'models.diffusion.InnerModelConfig', 'img_channels': 3, 'num_steps_conditioning': 1, 'cond_channels': 2048, 'depths': [2, 2, 2, 2], 'channels': [64, 64, 128, 256], 'attn_depths': [0, 0, 0, 1]}}, 'rew_end_model': None, 'actor_critic': None}, 'world_model_env': {'_target_': 'envs.WorldModelEnvConfig', 'horizon': 1000, 'num_batches_to_preload': 256, 'diffusion_sampler_next_obs': {'_target_': 'models.diffusion.DiffusionSamplerConfig', 'num_steps_denoising': 1, 'sigma_min': 0.002, 'sigma_max': 5.0, 'rho': 7, 'order': 1, 's_churn': 0.0, 's_tmin': 0.0, 's_tmax': '${eval:\\'float(\"inf\")\\'}', 's_noise': 1.0, 's_cond': 0.005}, 'diffusion_sampler_upsampling': {'_target_': 'models.diffusion.DiffusionSamplerConfig', 'num_steps_denoising': 1, 'sigma_min': 1, 'sigma_max': 5.0, 'rho': 7, 'order': 2, 's_churn': 10.0, 's_tmin': 1, 's_tmax': 5, 's_noise': 0.9, 's_cond': 0}}}\n"]},{"output_type":"display_data","data":{"text/plain":["Fetching 67 files:   0%|          | 0/67 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ce345bec136e436abf5c39f4b36e711d"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/content/drive/MyDrive/colab-diamond-csgo/src/agent.py:66: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  sd = torch.load(Path(path_to_ckpt), map_location=self.device)\n"]},{"output_type":"stream","name":"stdout","text":["\n","Controls:\n","\n"," m  : switch control (human/replay)\n"," .  : pause/unpause\n"," e  : step-by-step (when paused)\n"," ⏎  : reset env\n","Esc : quit\n","\n","\n"]},{"output_type":"display_data","data":{"text/plain":["FloatSlider(value=0.0, description='Steering', max=1.0, min=-1.0)"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"615676846859429780644f7d9e0e0aed"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Output()"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a0eecb1a9ada47fbb8ee2b6c2821d185"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Button(description='Stop Task', style=ButtonStyle())"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"732b3164e2a4477fadcbd2f9dea93273"}},"metadata":{}}],"source":["%matplotlib inline\n","%run src/play.py --colab"]},{"cell_type":"code","source":[],"metadata":{"id":"EtsI2xUi9jjQ"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"gpuType":"T4","machine_shape":"hm","mount_file_id":"1B63q1QSxadEPbkkzpMV6WR_R3ZBj-cXk","authorship_tag":"ABX9TyMj1vhv+OOmt181X1JHVBQC"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"ce345bec136e436abf5c39f4b36e711d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_670c8db2350d4a69b6455c7fff335c2f","IPY_MODEL_ae7b118b01f1449c9bfdd6c616bf37c8","IPY_MODEL_694bc9fbf4a7439685a18f0d28a137d6"],"layout":"IPY_MODEL_ee5b048fcca64c718a4b438b64cdafed"}},"670c8db2350d4a69b6455c7fff335c2f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0893d6990404416ea5b1c9919503215a","placeholder":"​","style":"IPY_MODEL_8ac7ecf0df80494792b524a944545958","value":"Fetching 67 files: 100%"}},"ae7b118b01f1449c9bfdd6c616bf37c8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f476eaa2f32f47e5a2c19d8bd7cd677f","max":67,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ff246f3910fd4bf5a4232c8ae71908da","value":67}},"694bc9fbf4a7439685a18f0d28a137d6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b1a230deb77649eb8bd5c6570edae081","placeholder":"​","style":"IPY_MODEL_0a431ead78854609abccae1e3a8a3b75","value":" 67/67 [00:00&lt;00:00, 2206.96it/s]"}},"ee5b048fcca64c718a4b438b64cdafed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0893d6990404416ea5b1c9919503215a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8ac7ecf0df80494792b524a944545958":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f476eaa2f32f47e5a2c19d8bd7cd677f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ff246f3910fd4bf5a4232c8ae71908da":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b1a230deb77649eb8bd5c6570edae081":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a431ead78854609abccae1e3a8a3b75":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"615676846859429780644f7d9e0e0aed":{"model_module":"@jupyter-widgets/controls","model_name":"FloatSliderModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatSliderModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"FloatSliderView","continuous_update":true,"description":"Steering","description_tooltip":null,"disabled":false,"layout":"IPY_MODEL_618752a82afb4ae0bfd7c49d064ee8d1","max":1,"min":-1,"orientation":"horizontal","readout":true,"readout_format":".2f","step":0.1,"style":"IPY_MODEL_9e24233b58cb4bbfb2ad7ad40d287b5b","value":-1}},"618752a82afb4ae0bfd7c49d064ee8d1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9e24233b58cb4bbfb2ad7ad40d287b5b":{"model_module":"@jupyter-widgets/controls","model_name":"SliderStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"SliderStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":"","handle_color":null}},"a0eecb1a9ada47fbb8ee2b6c2821d185":{"model_module":"@jupyter-widgets/output","model_name":"OutputModel","model_module_version":"1.0.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/output","_model_module_version":"1.0.0","_model_name":"OutputModel","_view_count":null,"_view_module":"@jupyter-widgets/output","_view_module_version":"1.0.0","_view_name":"OutputView","layout":"IPY_MODEL_79696bcfa84b4fd1b473b4e71f49102b","msg_id":"","outputs":[]}},"79696bcfa84b4fd1b473b4e71f49102b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"732b3164e2a4477fadcbd2f9dea93273":{"model_module":"@jupyter-widgets/controls","model_name":"ButtonModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ButtonModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ButtonView","button_style":"","description":"Stop Task","disabled":false,"icon":"","layout":"IPY_MODEL_48675cae40804c06ba3b18222de8973b","style":"IPY_MODEL_75a4486ff976488b9a3c02a442830600","tooltip":""}},"48675cae40804c06ba3b18222de8973b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"75a4486ff976488b9a3c02a442830600":{"model_module":"@jupyter-widgets/controls","model_name":"ButtonStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ButtonStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","button_color":null,"font_weight":""}}}},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}